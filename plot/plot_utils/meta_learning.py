import matplotlib.pyplot as plt
import matplotlib.colors as mc
import numpy as np

## 折线配置
lw_1, lw_2, lw_3, lw_4 = 1, 1.25, 1.5, 1.75
ms_1, ms_2, ms_3, ms_4 = 1, 1.25, 1.5, 2
mk_1, mk_2, mk_3, mk_4 = "o", "v", "*", "D"
pt_1, pt_2, pt_3, pt_4 = ':', '--', '-', '-.'
co_1, co_2, co_3, co_4, co_5 = mc.TABLEAU_COLORS['tab:blue'], mc.TABLEAU_COLORS['tab:orange'], mc.TABLEAU_COLORS['tab:green'], mc.TABLEAU_COLORS['tab:red'],  mc.TABLEAU_COLORS['tab:pink']


fig, ax = plt.subplots(3, 1, figsize=(8, 6))
## CLEBA 小数据集
e_1 = np.arange(100, 30001, 100)
e_2 = np.arange(100, 6001, 100)
psnr_1 = [ 16.1786, 21.1956, 23.8035, 25.3930, 26.2172, 27.0383, 27.4633, 27.8911, 28.0801, 28.2936, 28.6374, 28.7349, 29.0293, 29.0856, 29.3037, 29.3921, 29.5815, 29.6361, 29.7716, 29.8405, 29.8902, 29.9625, 30.0511, 30.1505, 30.2154, 30.2840, 30.3911, 30.4295, 30.4641, 30.5246, 30.5813, 30.6084, 30.6189, 30.7019, 30.7301, 30.7942, 30.8079, 30.8239, 30.8746, 30.9192, 30.9821, 31.0054, 31.0266, 31.0891, 31.1129, 31.1129, 31.1626, 31.1839, 31.2098, 31.2308, 31.2625, 31.2633, 31.2945, 31.3464, 31.3539, 31.3845, 31.3954, 31.4000, 31.4306, 31.4574, 31.4708, 31.4853, 31.5222, 31.5354, 31.5437, 31.5544, 31.5881, 31.5881, 31.5984, 31.6376, 31.6396, 31.6484, 31.6647, 31.6764, 31.6900, 31.6934, 31.7065, 31.7269, 31.7399, 31.7484, 31.7680, 31.7976, 31.7994, 31.8221, 31.8238, 31.8315, 31.8393, 31.8553, 31.8595, 31.8789, 31.8863, 31.8885, 31.8956, 31.9159, 31.9159, 31.9213, 31.9291, 31.9485, 31.9553, 31.9555,
32.4882, 33.8101, 35.1848, 35.5620, 35.7744, 35.8913, 35.9705, 36.0361, 36.0795, 36.1141, 36.1303, 36.1549, 36.1884, 36.2003, 36.2181, 36.2290, 36.2479, 36.2594, 36.2743, 36.2854, 36.2872, 36.2981, 36.3056, 36.3141, 36.3194, 36.3338, 36.3340, 36.3402, 36.3438, 36.3471, 36.3471, 36.3608, 36.3678, 36.3711, 36.3745, 36.3763, 36.3763, 36.3813, 36.3847, 36.3936, 36.3936, 36.3975, 36.4003, 36.4003, 36.4013, 36.4013, 36.4071, 36.4127, 36.4140, 36.4140, 36.4166, 36.4166, 36.4230, 36.4270, 36.4277, 36.4324, 36.4343, 36.4396, 36.4402, 36.4429, 36.4458, 36.4482, 36.4513, 36.4519, 36.4523, 36.4550, 36.4568, 36.4584, 36.4612, 36.4640, 36.4643, 36.4651, 36.4663, 36.4677, 36.4677, 36.4680, 36.4680, 36.4716, 36.4716, 36.4748, 36.4755, 36.4755, 36.4776, 36.4776, 36.4787, 36.4787, 36.4805, 36.4849, 36.4849, 36.4852, 36.4852, 36.4858, 36.4858, 36.4858, 36.4868, 36.4879, 36.4880, 36.4891, 36.4893, 36.4893,
37.5503, 38.3054, 39.2320, 39.5843, 39.7452, 39.8580, 39.9260, 39.9978, 40.0366, 40.0682, 40.1076, 40.1364, 40.1513, 40.1686, 40.1900, 40.1927, 40.2031, 40.2204, 40.2261, 40.2375, 40.2462, 40.2583, 40.2635, 40.2680, 40.2758, 40.2819, 40.2854, 40.2916, 40.2949, 40.3014, 40.3071, 40.3111, 40.3134, 40.3205, 40.3268, 40.3268, 40.3324, 40.3345, 40.3351, 40.3367, 40.3371, 40.3371, 40.3430, 40.3492, 40.3492, 40.3503, 40.3603, 40.3616, 40.3666, 40.3666, 40.3679, 40.3691, 40.3708, 40.3727, 40.3733, 40.3778, 40.3786, 40.3793, 40.3823, 40.3827, 40.3845, 40.3882, 40.3894, 40.3904, 40.3906, 40.3926, 40.3955, 40.3955, 40.3955, 40.3987, 40.3998, 40.3998, 40.4023, 40.4023, 40.4036, 40.4049, 40.4054, 40.4078, 40.4088, 40.4099, 40.4113, 40.4126, 40.4141, 40.4146, 40.4148, 40.4148, 40.4148, 40.4156, 40.4156, 40.4183, 40.4183, 40.4188, 40.4188, 40.4188, 40.4199, 40.4204, 40.4236, 40.4262, 40.4274, 40.4274,]
psnr_2 = [ 26.7032, 28.1207, 28.8973, 29.4418, 29.8518, 30.2009, 30.4884, 30.7219, 30.9149, 31.0777, 31.1903, 31.3452, 31.4385, 31.5203, 31.6323, 31.7220, 31.7894, 31.8326, 31.9224, 31.9560,
32.7751, 35.4731, 35.9555, 36.1287, 36.2380, 36.2894, 36.3485, 36.3826, 36.4269, 36.4350, 36.4598, 36.4759, 36.4884, 36.5071, 36.5160, 36.5248, 36.5303, 36.5432, 36.5432, 36.5539,
37.7235, 38.8076, 39.6588, 39.9431, 40.0599, 40.1335, 40.1894, 40.2323, 40.2668, 40.2912, 40.3119, 40.3244, 40.3396, 40.3564, 40.3637, 40.3661, 40.3739, 40.3873, 40.3902, 40.3973,]
ax[0].plot(e_2, psnr_2, pt_3, label="WSIC (Meta-learned) ", c=co_1, linewidth=lw_1)
ax[0].plot(e_1, psnr_1, pt_3, label="WSIC (Basic)", c=co_2, linewidth=lw_1)
ax[0].set_ylabel("PSNR [db]")
ax[0].set_xlabel("Number of epochs")
ax[0].set_xlim(0, 30000)
ax[0].set_ylim(20, 42)
ax[0].grid()
ax[0].legend(loc='lower right')
ax[0].xaxis.set_ticks([0, 6000, 12000, 18000, 24000, 30000])

e_1 = np.arange(100, 30001, 100)
e_2 = np.arange(100, 6001, 100)
psnr_1 = [ 17.5508, 22.6342, 24.2512, 25.0832, 25.6349, 26.0628, 26.4104, 26.6933, 26.9262, 27.1272, 27.3099, 27.4823, 27.6462, 27.7970, 27.9332, 28.0582, 28.1753, 28.2838, 28.3827, 28.4738, 28.5585, 28.6370, 28.7095, 28.7767, 28.8400, 28.9007, 28.9592, 29.0156, 29.0696, 29.1213, 29.1706, 29.2177, 29.2630, 29.3064, 29.3484, 29.3889, 29.4281, 29.4658, 29.5019, 29.5362, 29.5691, 29.6008, 29.6318, 29.6622, 29.6921, 29.7215, 29.7504, 29.7786, 29.8061, 29.8328, 29.8585, 29.8834, 29.9074, 29.9307, 29.9533, 29.9754, 29.9971, 30.0185, 30.0397, 30.0608, 30.0818, 30.1029, 30.1239, 30.1448, 30.1656, 30.1861, 30.2061, 30.2255, 30.2443, 30.2623, 30.2798, 30.2965, 30.3128, 30.3285, 30.3439, 30.3591, 30.3740, 30.3888, 30.4036, 30.4182, 30.4329, 30.4475, 30.4621, 30.4768, 30.4913, 30.5057, 30.5199, 30.5338, 30.5474, 30.5607, 30.5736, 30.5862, 30.5984, 30.6103, 30.6219, 30.6333, 30.6443, 30.6552, 30.6659, 30.6765,
30.8026, 31.4667, 32.3865, 33.4633, 34.1813, 34.6518, 34.9163, 35.4152, 35.5297, 35.7015, 35.7945, 36.1605, 36.3094, 36.5822, 36.5822, 36.7553, 36.8364, 36.8364, 36.9750, 36.9750, 37.0117, 37.0873, 37.1857, 37.1891, 37.1891, 37.1891, 37.2512, 37.3384, 37.4056, 37.4091, 37.4091, 37.4884, 37.5066, 37.5066, 37.5381, 37.5381, 37.6294, 37.6372, 37.6372, 37.6372, 37.6372, 37.6634, 37.6634, 37.7660, 37.7660, 37.7660, 37.7660, 37.7660, 37.7660, 37.8006, 37.8006, 37.8815, 37.8815, 37.8815, 37.8815, 37.8815, 37.8815, 37.8815, 37.8815, 37.8815, 37.9009, 37.9009, 37.9009, 37.9009, 37.9822, 37.9822, 37.9822, 37.9822, 37.9822, 37.9822, 37.9822, 37.9822, 37.9822, 37.9822, 37.9822, 37.9949, 37.9949, 38.0461, 38.0461, 38.0588, 38.0588, 38.0588, 38.0813, 38.0813, 38.1155, 38.1155, 38.1155, 38.1155, 38.1197, 38.1197, 38.1197, 38.1197, 38.1197, 38.1197, 38.1197, 38.1197, 38.1197, 38.1197, 38.1197, 38.1197,
38.0823, 38.1681, 38.1864, 38.1864, 38.1864, 38.1864, 38.2645, 38.3557, 38.3557, 38.3919, 38.7345, 38.7793, 39.0452, 39.2641, 39.4804, 39.6662, 39.7286, 39.9410, 39.9410, 40.0671, 40.1936, 40.3014, 40.3014, 40.5470, 40.5470, 40.7056, 40.7056, 40.7056, 40.7056, 40.7272, 40.7272, 40.7514, 40.7514, 40.7514, 40.7579, 41.1700, 41.1700, 41.1700, 41.1700, 41.1700, 41.1969, 41.1969, 41.1969, 41.1969, 41.1969, 41.1969, 41.2640, 41.2787, 41.2787, 41.2787, 41.2974, 41.2974, 41.4075, 41.4075, 41.4075, 41.4734, 41.4734, 41.4734, 41.4734, 41.4734, 41.4734, 41.4734, 41.4734, 41.4734, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.4974, 41.5063, 41.5063, 41.5063, 41.5063, 41.5063, 41.5063, 41.5063, 41.5545, 41.5545, 41.5545, 41.5545, 41.5660, 41.5660, 41.5660, 41.5903, 41.5903, 41.5903, 41.5903, 41.5903, 41.5903,]
psnr_2 = [ 27.1217, 27.9221, 28.3740, 28.6773, 28.9035, 29.0935, 29.2579, 29.3996, 29.5213, 29.6241, 29.7124, 29.7910, 29.8635, 29.9319, 29.9974, 30.0604, 30.1191, 30.1722, 30.2200, 30.2632,
30.3021, 30.3756, 31.6994, 34.1574, 35.0112, 35.4712, 35.5592, 35.9218, 35.9218, 36.1971, 36.2904, 36.3464, 36.3464, 36.3556, 36.4205, 36.4537, 36.5155, 36.5176, 36.5364, 36.5364,
 36.6142, 37.0920, 37.8697, 38.6196, 39.1664, 39.1664, 39.4387, 39.4422, 39.6908, 39.6908, 39.7074, 39.8698, 40.0077, 40.1009, 40.1009, 40.1009, 40.1657, 40.2281, 40.2916, 40.2916,]
ax[1].plot(e_2, psnr_2, pt_3, label="DSIC (Meta-learned) ", c=co_1, linewidth=lw_1)
ax[1].plot(e_1, psnr_1, pt_3, label="DSIC (Basic)", c=co_2, linewidth=lw_1)
ax[1].set_ylabel("PSNR [db]")
ax[1].set_xlabel("Number of epochs")
ax[1].set_xlim(0, 30000)
ax[1].set_ylim(20, 44)
ax[1].grid()
ax[1].legend(loc='lower right')
ax[1].xaxis.set_ticks([0, 6000, 12000, 18000, 24000, 30000])

e_1 = np.arange(100, 30001, 100)
e_2 = np.arange(100, 6001, 100)
psnr_1 = [ 12.6310, 17.4687, 21.7368, 24.5379, 26.3829, 27.5402, 28.2556, 28.7117, 29.0325, 29.2775, 29.4728, 29.6337, 29.7705, 29.8897, 29.9945, 30.0874, 30.1716, 30.2504, 30.3266, 30.4013, 30.4739, 30.5435, 30.6104, 30.6745, 30.7358, 30.7942, 30.8503, 30.9045, 30.9570, 31.0084, 31.0591, 31.1086, 31.1563, 31.2015, 31.2440, 31.2836, 31.3205, 31.3552, 31.3880, 31.4193, 31.4493, 31.4782, 31.5061, 31.5332, 31.5595, 31.5852, 31.6103, 31.6349, 31.6588, 31.6822, 31.7050, 31.7272, 31.7489, 31.7703, 31.7914, 31.8123, 31.8328, 31.8530, 31.8728, 31.8923, 31.9115, 31.9303, 31.9489, 31.9672, 31.9852, 32.0029, 32.0203, 32.0373, 32.0541, 32.0706, 32.0868, 32.1026, 32.1183, 32.1336, 32.1487, 32.1636, 32.1784, 32.1930, 32.2074, 32.2218, 32.2361, 32.2503, 32.2643, 32.2782, 32.2919, 32.3054, 32.3187, 32.3317, 32.3445, 32.3571, 32.3695, 32.3816, 32.3936, 32.4055, 32.4172, 32.4289, 32.4405, 32.4521, 32.4637, 32.4753,
32.5286, 32.6611, 32.8005, 33.7305, 34.3802, 34.7963, 35.0687, 35.2850, 35.4510, 35.5065, 35.6851, 35.7762, 35.8540, 35.8906, 35.9737, 36.0239, 36.0420, 36.1085, 36.1216, 36.1733, 36.2015, 36.2015, 36.2547, 36.2782, 36.2899, 36.3093, 36.3361, 36.3516, 36.3679, 36.3679, 36.3978, 36.4047, 36.4255, 36.4396, 36.4522, 36.4522, 36.4748, 36.4748, 36.4971, 36.5009, 36.5174, 36.5280, 36.5376, 36.5472, 36.5572, 36.5682, 36.5773, 36.5872, 36.5964, 36.6050, 36.6126, 36.6175, 36.6246, 36.6334, 36.6334, 36.6452, 36.6510, 36.6557, 36.6610, 36.6646, 36.6687, 36.6687, 36.6753, 36.6753, 36.6753, 36.6892, 36.6901, 36.6965, 36.6965, 36.6965, 36.7056, 36.7056, 36.7056, 36.7056, 36.7168, 36.7168, 36.7168, 36.7168, 36.7257, 36.7257, 36.7257, 36.7302, 36.7347, 36.7375, 36.7403, 36.7403, 36.7403, 36.7410, 36.7490, 36.7490, 36.7492, 36.7492, 36.7566, 36.7566, 36.7566, 36.7600, 36.7640, 36.7640, 36.7640, 36.7695,
36.8007, 36.9244, 37.0869, 37.1789, 37.2405, 37.2928, 37.3490, 37.4189, 37.5020, 37.6046, 37.7353, 37.9609, 38.2126, 38.3997, 38.5332, 38.6408, 38.7004, 38.8083, 38.8774, 38.9436, 38.9975, 39.0485, 39.0964, 39.1357, 39.1760, 39.2130, 39.2130, 39.2732, 39.2998, 39.3232, 39.3441, 39.3610, 39.3798, 39.3987, 39.4160, 39.4305, 39.4456, 39.4592, 39.4718, 39.4838, 39.4955, 39.4955, 39.5166, 39.5276, 39.5385, 39.5491, 39.5593, 39.5692, 39.5790, 39.5790, 39.5964, 39.6058, 39.6150, 39.6150, 39.6306, 39.6386, 39.6459, 39.6528, 39.6593, 39.6655, 39.6713, 39.6768, 39.6791, 39.6865, 39.6915, 39.6915, 39.7002, 39.7049, 39.7094, 39.7094, 39.7171, 39.7211, 39.7247, 39.7247, 39.7307, 39.7340, 39.7370, 39.7399, 39.7427, 39.7454, 39.7454, 39.7504, 39.7530, 39.7530, 39.7578, 39.7604, 39.7604, 39.7651, 39.7676, 39.7676, 39.7721, 39.7746, 39.7746, 39.7786, 39.7811, 39.7811, 39.7858, 39.7881, 39.7881, 39.7923,]
psnr_2 = [ 29.6547, 30.4228, 30.8558, 31.1650, 31.4088, 31.6164, 31.7884, 31.9242, 32.0373, 32.1319, 32.2104, 32.2758, 32.3322, 32.3834, 32.4327, 32.4816, 32.5292, 32.5741, 32.6158, 32.6543,
32.8228, 32.9440, 33.0112, 33.1399, 34.0490, 34.5658, 34.8926, 35.1212, 35.2745, 35.3960, 35.4901, 35.5635, 35.6314, 35.6788, 35.7129, 35.7386, 35.7610, 35.7806, 35.7971, 35.8125,
 36.0460, 36.3630, 36.8031, 37.3552, 37.9005, 38.2197, 38.3962, 38.5110, 38.5908, 38.6566, 38.7088, 38.7469, 38.7936, 38.8261, 38.8569, 38.8805, 38.9028, 38.9028, 38.9419, 38.9581]
ax[2].plot(e_2, psnr_2, pt_3, label="WDSIC (Meta-learned) ", c=co_1, linewidth=lw_1)
ax[2].plot(e_1, psnr_1, pt_3, label="WDSIC (Basic)", c=co_2, linewidth=lw_1)
ax[2].set_ylabel("PSNR [db]")
ax[2].set_xlabel("Number of epochs")
ax[2].set_xlim(0, 30000)
ax[2].set_ylim(20, 44)
ax[2].grid()
ax[2].legend(loc='lower right')
ax[2].xaxis.set_ticks([0, 6000, 12000, 18000, 24000, 30000])

title = "meta_learning.jpg"
fig.savefig(f"./plot_imgs/{title}", dpi=300, bbox_inches='tight')
print(f"plot:  {title}")
plt.clf()
plt.close()